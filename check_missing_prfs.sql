-- Check missing PRFs from the expected list
WITH ExpectedPRFs AS (
  SELECT PRFNo FROM (VALUES 
    (22148), (22644), (22666), (22789), (22829), (22916), (23089), (23090), (23091), (23092),
    (23196), (23345), (23462), (23463), (23469), (23505), (23853), (23854), (23892), (23906),
    (23919), (23921), (24033), (24171), (24228), (24257), (24258), (24259), (24316), (24318),
    (24330), (24342), (24478), (24488), (24566), (24665), (24730), (24920), (24921), (24926),
    (25000), (25083), (25206), (25257), (25258), (25343), (25433), (25475), (25564), (25762),
    (25796), (25818), (25902), (25999), (26037), (26043), (26275), (26280), (26325), (26336),
    (26437), (26564), (26608), (26723), (26877), (26974), (26983), (27072), (27348), (27497),
    (27543), (27654), (27672), (27983), (28082), (28083), (28106), (28109), (28134), (28137),
    (28139), (28151), (28210), (28222), (28248), (28296), (28359), (28361), (28364), (28394),
    (28440), (28443), (28475), (28617), (28625), (28649), (28715), (28755), (28756), (28761),
    (28762), (29000), (29005), (29054), (29085), (29224), (29227), (29293), (29294), (29395),
    (29417), (29440), (29509), (29629), (29777), (29840), (29891), (29987), (29990), (29991),
    (29997), (29998), (30105), (30110), (30111), (30183), (30291), (30293), (30294), (30335),
    (30436), (30448), (30471), (30610), (30611), (30631), (30715), (30716), (30730), (30732),
    (30733), (30734), (30874), (30987), (30988), (31092), (31376), (31410), (31555), (31571),
    (31573), (31690), (31810), (31815), (31882), (31885), (31922), (31947), (32307), (32309),
    (32397), (32419), (32423), (32555), (32664), (32751), (32852), (32853), (32867), (33041),
    (33113), (33121), (33157), (33344), (33346), (33347), (33850), (33852), (33865), (33867),
    (33894), (33895), (33896), (33930), (33945), (33960), (34100), (34206), (34275)
  ) AS t(PRFNo)
)
SELECT 
  'Database Statistics' as Type,
  COUNT(*) as Count
FROM PRF
UNION ALL
SELECT 
  'Expected PRFs' as Type,
  COUNT(*) as Count
FROM ExpectedPRFs
UNION ALL
SELECT 
  'Missing PRFs' as Type,
  COUNT(*) as Count
FROM ExpectedPRFs e
LEFT JOIN PRF p ON e.PRFNo = p.PRFNo
WHERE p.PRFNo IS NULL;

-- Show the actual missing PRF numbers
SELECT 
  e.PRFNo as MissingPRFNo
FROM ExpectedPRFs e
LEFT JOIN PRF p ON e.PRFNo = p.PRFNo
WHERE p.PRFNo IS NULL
ORDER BY e.PRFNo;

-- Show PRFs that exist in database but not in expected list (extras)
SELECT 
  p.PRFNo as ExtraPRFNo,
  p.Title,
  p.Status,
  p.CreatedAt
FROM PRF p
LEFT JOIN ExpectedPRFs e ON p.PRFNo = e.PRFNo
WHERE e.PRFNo IS NULL
ORDER BY p.PRFNo;